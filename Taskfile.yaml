version: 3

tasks:
  format:
    cmd: uv run ruff format

  check:
    cmd: uv run ruff check

  sync:
    cmd: uv sync

  list:
    cmd: uv run xpic-cli list

  save:
    cmd: uv run xpic-cli save

  run:
    cmd: uv run xpic

  gen:
    dir: assets
    cmds:
      - uv run img-conv -i xpic.png -o xpic.ico
    sources:
      - xpic.png
    generates:
      - xpic.ico

  bundle-cli:
    deps:
      - gen
    cmds:
      - uv run pyinstaller --onefile --name=xpic-cli --icon=assets/xpic.ico xpic_cli/__main__.py

  bundle-gui:
    deps:
      - gen
    cmds:
      - uv run pyinstaller --add-data "assets/xpic.png:assets"  --add-data "assets/xpic.qss:assets" --onefile --name=xpic --icon=assets/xpic.ico --windowed xpic_gui/__main__.py

  bundle:
    deps:
      - bundle-cli
      - bundle-gui
